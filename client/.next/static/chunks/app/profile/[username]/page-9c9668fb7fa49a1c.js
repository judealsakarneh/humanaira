(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6381],{63:(e,t,a)=>{"use strict";var s=a(7260);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},2318:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(5155),r=a(2115),i=a(63);function n(){var e;let{id:t}=(0,i.useParams)(),[a,n]=(0,r.useState)(null),[l,o]=(0,r.useState)(""),[c,d]=(0,r.useState)({rating:5,comment:""}),[u,m]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{var e;let a=await fetch("/api/order/".concat(t)),s=await a.json();if(n(s.order),(null==(e=s.order)?void 0:e.status)==="COMPLETED"){let e=await fetch("/api/reviews?order_id=".concat(t));m(!!(await e.json()).review)}})()},[t]);let x=async e=>{let a=await fetch("/api/order/".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:e,note:l})}),s=await a.json();a.ok?n(s.order):alert(s.error||"Error")},h=async()=>{(await fetch("/api/reviews",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order_id:t,...c})})).ok?(alert("Review submitted!"),m(!0)):alert("Error submitting review")};return a?(0,s.jsxs)("main",{className:"max-w-3xl mx-auto px-6 py-10",children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold mb-3",children:null==(e=a.gig)?void 0:e.title}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 mb-4",children:["Status: ",a.status]}),(0,s.jsx)("textarea",{className:"border w-full p-3",rows:4,placeholder:"Message or delivery note",value:l,onChange:e=>o(e.target.value)}),(0,s.jsxs)("div",{className:"flex gap-3 mt-3",children:["IN_PROGRESS"===a.status&&(0,s.jsx)("button",{onClick:()=>x("DELIVER"),className:"px-3 py-2 bg-black text-white rounded",children:"Deliver"}),"DELIVERED"===a.status&&(0,s.jsx)("button",{onClick:()=>x("ACCEPT"),className:"px-3 py-2 bg-green-600 text-white rounded",children:"Accept"})]}),"COMPLETED"===a.status&&!u&&(0,s.jsxs)("div",{className:"mt-8 border-t pt-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Leave a Review"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)("span",{children:"Rating:"}),(0,s.jsx)("input",{type:"number",min:1,max:5,value:c.rating,onChange:e=>d(t=>({...t,rating:Number(e.target.value)})),className:"border rounded w-16 p-1"}),(0,s.jsx)("span",{className:"text-yellow-600",children:"★".repeat(c.rating)})]}),(0,s.jsx)("textarea",{className:"border w-full p-2 mb-2",rows:3,placeholder:"Write your review...",value:c.comment,onChange:e=>d(t=>({...t,comment:e.target.value}))}),(0,s.jsx)("button",{onClick:h,className:"px-4 py-2 bg-black text-white rounded",children:"Submit Review"})]}),"COMPLETED"===a.status&&u&&(0,s.jsx)("div",{className:"mt-8 text-green-600",children:"You have already reviewed this order."})]}):(0,s.jsx)("div",{className:"p-10",children:"Loading…"})}},7454:(e,t,a)=>{Promise.resolve().then(a.bind(a,2318))}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=7454)),_N_E=e.O()}]);